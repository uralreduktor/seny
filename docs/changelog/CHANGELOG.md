# История изменений

Все значимые изменения в проекте документируются в этом файле.

Формат основан на [Keep a Changelog](https://keepachangelog.com/ru/1.0.0/),
и проект придерживается [Semantic Versioning](https://semver.org/lang/ru/).

## [Не выпущено]

### Добавлено

- ERD и архитектурное описание справочника номенклатуры
  (`docs/architecture/nomenclature.md`, `docs/architecture/diagrams/nomenclature_ERD.mmd`,
  `docs/architecture/domain-map.md`).
- OpenAPI-спецификация `docs/development/api/nomenclature.yaml`
  с namespace `/api/v1/nomenclature/*`.
- Новый API `backend/app/api/v1/endpoints/nomenclature.py`
  (узлы классификатора, версии схем и карточки).
- Совместимый слой `/api/v1/nomenclatures/*` для существующих клиентов;
  документация дополнена разделом «Номенклатура».
- Массовые операции для карточек номенклатуры: эндпоинты
  `POST /nomenclature/cards/bulk/lifecycle` и `POST /nomenclature/cards/bulk/methodology`,
  схемы запросов/ответов и описание в OpenAPI.

### Изменено

- Перестроена модель `Nomenclature`: жизненный цикл, связь с деревом узлов,
  атрибуты карточки, векторные эмбеддинги.
- Добавлены миграции `734112275faa_nomenclature_rebuild` и merge-ревизия `21502979c246`
  (таблицы `nomenclature_nodes`, `nomenclature_class_schema`, версии/синонимы/использование карточек,
  новые поля `nomenclatures`).
- Реализованы сервисы и схемы для работы с карточками/классификатором,
  а также юнит-тест сериализации карточки.
- Frontend обновлён: страницы/диалоги номенклатуры работают с `/api/v1/nomenclature/cards`,
  добавлены расширенные фильтры/сортировки, выбор карточек и UI для массовых операций.

### Исправлено

- Ошибка сериализации `/api/v1/nomenclatures/` (конфликт имени `synonyms` между JSON-полем и связью)
  приводила к 500 на фронте; исправлено переименованием связей `synonym_records`/`usage_records`.

## [0.1.0] - 2025-01-XX

### Добавлено

- Базовая структура проекта
- Документация проекта в папке `docs/`
- Конфигурация Docker Compose для development
- Базовая структура backend (FastAPI)
- Базовая структура frontend (React + TypeScript)
- OpenAPI спецификация и генерация TypeScript клиентов
- Конфигурация PostgreSQL с pgvector
- Конфигурация Redis и Celery
- Конфигурация MinIO для хранения файлов

### Документация

- README.md с описанием проекта
- Структура документации в `docs/`
- Техническое задание (project_brief.md)
- Анализ текущего состояния (analysis_current_state.md)
- Документация по архитектуре
- Документация модулей
- Инструкции по установке и настройке
- API документация

---

## Типы изменений

- **Added** — новые функции
- **Changed** — изменения в существующей функциональности
- **Deprecated** — функции, которые скоро будут удалены
- **Removed** — удалённые функции
- **Fixed** — исправления багов
- **Security** — исправления уязвимостей

## Формат записей

```markdown
## [Версия] - YYYY-MM-DD

### Добавлено
- Новая функция X

### Изменено
- Изменение в функции Y

### Исправлено
- Исправлен баг Z
```

---

**Примечание**: Этот файл будет обновляться по мере разработки проекта.
